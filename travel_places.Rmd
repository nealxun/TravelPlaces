---
title: "Travel Places"
author: "Small Ni and Big Fu"
date: "`r Sys.Date()`"
output: 
        html_document:
                keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(leaflet)
library(tidyverse)
library(RCurl)
library(htmltools)
library(mapview)
library(prettydoc)
```

## National Parks And Cities

```{r read and process data, include=FALSE}
df_raw <- read.csv("https://raw.githubusercontent.com/nealxun/TravelPlaces/master/travel_places.csv", stringsAsFactors = FALSE)

df_raw$date <- as.Date(df_raw$date, format = "%m/%d/%y")

df_places <- df_raw %>%
        mutate(info = paste(sep = "<br/>", num, date, place))

```

```{r maps, echo = FALSE, warning=FALSE, message=FALSE}
# places information (sequence, date, place name), show when hover the mice
nums <- paste0("<b>", df_places$num, "</b>")
placesInfo <- paste(sep = "<br/>", nums, df_places$date, df_places$place)

# pictures link, clice the marker
placesPics <- df_raw$pic

# customized icons
icon_list <- iconList(
        nature = makeIcon("https://raw.githubusercontent.com/nealxun/TravelPlaces/master/national-park-map-icons.png", iconWidth = 24, iconHeight = 30),
        city = makeIcon("https://raw.githubusercontent.com/nealxun/TravelPlaces/master/city_icon.png", iconWidth = 24, iconHeight = 30))

# draw the map
df_places %>% 
        leaflet() %>%
        addTiles() %>%
        addMarkers(clusterOptions = markerClusterOptions(),
                 lat = ~latitude, lng = ~longtitude,
                 label = lapply(placesInfo, HTML), # multiple lines
                 popup = popupImage(placesPics),
                 #color = ~color,
                 icon = ~icon_list[df_places$icon]) %>%
        # add numbers on the map
        addLabelOnlyMarkers(lat = ~latitude, lng = ~longtitude, label = ~as.character(num),
                            labelOptions = labelOptions(noHide = TRUE, textOnly = FALSE, 
                                                        textsize = "10px", opacity = 0.8)) %>%
        # add legend, could potentially add to be visited places
        addLegend(labels = unique(df_places$icon), col = unique(df_places$color))
```


